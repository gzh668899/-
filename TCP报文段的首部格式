+ TCP是面向字节流的，但是TCP传送的数据单元是报文段
+ TCP报文段分为首部和数据两部分
+ TCP报文段首部的前20个字节是固定的，后面有4n字节（n是整数）是根据需要而增加的选项，因此TCP首部的最小长度是20字节
  + 源端口号，2字节
  + 目的端口号，2字节
    + 与UDP类似，TCP的分用功能也是通过端口实现的
  + 序号，4字节
    + 共2^32^个序号,序号范围[0，2^32^-1]，序号增加到2^32^-1后，下一个序号又回到0
    + TCP是面向字节流的,在一个TCP连接中传送的字节流中的每一个字节都按顺序编号
    + 整个要传送的字节流的起始序号必须在连接建立时设置
    + 序号字段值指的是本报文段所发送的数据的第一个字节的序号
    + 这个字段的名称也叫做“报文段序号”
  + 确认号，4字节
    + 期望收到对方下一个报文段的第一个数据字节的序号
    + 若确认号=N，则表明到序号N-1为止的所有数据都已正确收到
  + 数据偏移，4位
    + TCP报文段的首部长度，单位是4字节
    + 4位二进制数能表示的最大十进制数是15
    + 数据偏移（TCP报文段的首部长度）最大值是60字节
  + 保留，6位
    + 置为0 
  + 标志位，6位
    + URG
      + URG=1时表示紧急指针字段有效
      + 发送方TCP将紧急数据插入到本报文段数据最前面
    + ACK
      + ACK=1时确认号字段有效，ACK=0时确认号字段无效
      + 连接建立后所有的报文段都必须把ACK置为1
    + PSH
      + PSH=1时，可以在键入一个命令后立即就能收到对方的响应
      + 发送方TCP立即创建一个报文段
      + 接收方TCP收到报文段后，立即交付应用进程，不用等到整个缓存都填满了再向上交付
    + RST
      + RST=1时，说明TCP连接出现严重差错，必须释放连接，重新建立连接
      + 或者是用来拒绝一个非法的报文段或拒绝打开一个连接
    + SYN
      + 在连接建立时用来同步序号
      + SYN=1,ACK=0，连接请求报文段
      + 若同意建立连接，则在响应报文段（连接接受报文段）中SYN=1,ACK=1
      + SYN=1说明该报文是一个连接请求段或连接接受报文段
    + FIN
      + FIN=1，报文段发送方的数据已发送完毕，要求释放连接
  + 窗口，2字节
    + 窗口字段的值范围是[0,2^16^-1]，单位是字节
    + 窗口指的是发送本报文段的一方的接收窗口
    + 窗口字段明确指出了现在允许对方发送的数据量，窗口值处于动态变化中
    + 例如，发送方TCP窗口字段位1000，即发送方TCP的接收缓存空间还可接收1000个字节数据
    + 用于TCP流量控制
  + 校验和，2字节
    + 校验和字段检验的范围包括首部和数据这两部分
    + 计算校验和时，要在TCP报文段的前面加上12字节的伪首部
  + 紧急指针，2字节 
    + 紧急指针仅在URG=1时才有意义，它指出了本报文的中紧急数据的字节数
    + 窗口为0的时候也可以发送紧急数据
  + 选项，最长可达40字节
    + 最大报文段长度MSS选项
      + MSS是TCP报文段中数据字段的最大长度，并不是整个TCP报文段的最大长度，而是TCP报文段长度减去TCP首部长度
      + 规定MSS的意义是
        + TCP报文段数据部分至少要加上40字节的首部，才能组成一个IP数据报
          + 若MSS较小，网络利用率就很低，例如TCP报文段只有1字节的数据，网络利用率只有1/41
          + 若MSS较大，会产生IP分片，在终点还需要将分片后的数据报重新装配，开销很大
      + MSS应该尽可能大，只要在IP层传输时不需要分片就行
      + 但由于IP数据报经历的路径是动态变化的，某条路径不需要分片，但另一条路径可能需要分片，最佳的MSS很难确定
      + 连接建立的过程中，双方都可以将字节能够支持的MSS写入这一字段，两个传输方向可以有不同的MSS值
      + MSS默认是536字节，互联网上所有主机都能接受的报文段长度是536+20=556字节
    + 窗口扩大选项
      + TCP首部中窗口字段的长度是2字节，16位，因此窗口大小最大为64KB
      + 窗口扩大选项占3字节，有1个字节表示移位值S，新窗口的窗口位数=（16+S），S最大值为14，即窗口范围扩大为[0-2^16+14^-1]
      + 窗口扩大选项可以在双方初始建立TCP连接时进行协商
      + 当某一段不需要扩大其窗口时，可发送S=0的选项，使得窗口大小回到16
    + 时间戳选项
      + 时间戳选项占10字节，主要包括时间戳值字段，4字节，时间戳回送回答字段，4字节
      + 计算往返时间RTT
      + 用于处理TCP序号超过2^32^的情况，为了使新报文段和之前的报文段区分开，可以加上时间戳
    + 选择确认选项（SACK）
